{% extends 'shared/base.html' %}
{% load static %}

{% block title %}Mentor Dashboard - LearnHub{% endblock %}
{% block page_title %}Mentor Dashboard{% endblock %}

{% block content %}
<div class="container">
  <!-- Welcome Header -->
  <div class="content-card" style="background: linear-gradient(135deg, var(--primary) 0%, #8b5cf6 100%); border: none;">
    <h2 style="font-size: var(--font-size-3xl); font-weight: 800; color: white; margin-bottom: var(--spacing-sm);">
      Welcome back, {{ request.user.first_name }}!
    </h2>
    <p style="color: rgba(255, 255, 255, 0.9); font-size: var(--font-size-lg); margin-bottom: var(--spacing-lg);">
      Here's what's happening with your courses today.
    </p>
    <a href="{% url 'mentor_course_add' %}" class="btn-primary-premium"
      style="width: auto; background: white; color: var(--primary);">
      <span class="material-icons">add</span>
      <span>Create New Course</span>
    </a>
  </div>

  <!-- Stats Grid -->
  <div class="grid grid-4" style="margin-bottom: var(--spacing-xl);">
    <div class="stat-card">
      <div class="stat-icon" style="background: var(--primary-light); color: var(--primary);">
        <span class="material-icons">library_books</span>
      </div>
      <div class="stat-info">
        <h3>{{ total_courses }}</h3>
        <p>Active Courses</p>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon" style="background: #ecfdf5; color: #10b981;">
        <span class="material-icons">group</span>
      </div>
      <div class="stat-info">
        <h3>{{ total_enrollments }}</h3>
        <p>Total Students</p>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon" style="background: #eff6ff; color: #3b82f6;">
        <span class="material-icons">verified</span>
      </div>
      <div class="stat-info">
        <h3>{{ completed_enrollments }}</h3>
        <p>Completions</p>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon" style="background: #fff7ed; color: #f59e0b;">
        <span class="material-icons">payments</span>
      </div>
      <div class="stat-info">
        <h3>Rp. 0</h3>
        <p>Total Revenue</p>
      </div>
    </div>
  </div>

  <!-- Courses Table -->
  <div class="content-card" style="padding: 0; overflow: hidden;">
    <div
      style="padding: var(--spacing-xl); border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
      <h2 style="font-size: var(--font-size-xl); font-weight: 700; color: var(--text-main); margin: 0;">Your Courses
      </h2>
    </div>

    <div style="overflow-x: auto;">
      <table class="premium-table">
        <thead>
          <tr>
            <th>Course Title</th>
            <th>Level</th>
            <th>Students</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for course in courses %}
          <tr>
            <td>
              <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                {% if course.thumbnail %}
                <img src="{{ course.thumbnail.url }}" alt="{{ course.title }}"
                  style="width: 48px; height: 48px; border-radius: var(--radius-lg); object-fit: cover;">
                {% else %}
                <div
                  style="width: 48px; height: 48px; background: var(--gray-100); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center;">
                  <span class="material-icons" style="color: var(--text-muted);">image</span>
                </div>
                {% endif %}
                <div>
                  <div style="font-weight: 600; color: var(--text-main);">{{ course.title }}</div>
                  <div style="font-size: var(--font-size-xs); color: var(--text-muted);">
                    {{ course.created_at|date:"M d, Y" }}
                  </div>
                </div>
              </div>
            </td>
            <td>
              <span class="badge-premium" style="font-size: var(--font-size-xs);">{{ course.get_level_display }}</span>
            </td>
            <td style="font-weight: 600;">{{ course.enrollment_set.count }}</td>
            <td>
              <div style="display: flex; align-items: center; gap: 6px; font-size: var(--font-size-sm);">
                <span
                  style="width: 8px; height: 8px; border-radius: 50%; background: {% if course.is_active %}var(--success){% else %}var(--text-muted){% endif %};"></span>
                <span style="color: {% if course.is_active %}var(--success){% else %}var(--text-muted){% endif %};">
                  {{ course.is_active|yesno:"Active,Inactive" }}
                </span>
              </div>
            </td>
            <td>
              <div style="display: flex; gap: var(--spacing-sm);">
                <a href="{% url 'mentor_course_detail' course.id %}" class="btn-preview" title="Edit">
                  <span class="material-icons" style="font-size: 18px;">edit</span>
                </a>
                <a href="{% url 'course_detail' course.id %}" class="btn-preview" title="View">
                  <span class="material-icons" style="font-size: 18px;">visibility</span>
                </a>
              </div>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" style="text-align: center; padding: var(--spacing-4xl);">
              <div
                style="width: 64px; height: 64px; margin: 0 auto var(--spacing-md); background: var(--gray-100); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center;">
                <span class="material-icons" style="font-size: 32px; color: var(--text-muted);">school</span>
              </div>
              <p style="font-weight: 600; color: var(--text-main);">No courses created yet.</p>
              <a href="{% url 'mentor_course_add' %}"
                style="color: var(--primary); font-size: var(--font-size-sm); text-decoration: none;">Create your first
                course</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
