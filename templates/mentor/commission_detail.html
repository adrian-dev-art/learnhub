{% extends 'shared/base.html' %}
{% load static admin_dashboard_tags %}

{% block title %}Commission Details - GampangBelajar{% endblock %}
{% block page_title %}Commission Details{% endblock %}

{% block extra_css %}
<style>
  .badge-status {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
  }

  .status-paid {
    background: #ecfdf5;
    color: #10b981;
  }

  .status-pending {
    background: #fff7ed;
    color: #f59e0b;
  }
</style>
{% endblock %}

{% block content %}
<div class="container">
  <!-- Header Card -->
  <div class="content-card"
    style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); border: none; margin-bottom: var(--spacing-xl);">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <div>
        <h2 style="font-size: var(--font-size-2xl); font-weight: 800; color: white; margin-bottom: var(--spacing-xs);">
          Total Commission
        </h2>
        <p style="color: rgba(255, 255, 255, 0.9); font-size: var(--font-size-lg);">
          Your earnings based on platform commission rules
        </p>
      </div>
      <div style="text-align: right; color: white;">
        <div style="font-size: var(--font-size-3xl); font-weight: 800;">Rp {{ total_commission|rupiah }}</div>
      </div>
    </div>
  </div>

  <!-- Transactions Table -->
  <div class="content-card" style="padding: 0; overflow: hidden;">
    <div
      style="padding: var(--spacing-xl); border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
      <h2 style="font-size: var(--font-size-xl); font-weight: 700; color: var(--text-main); margin: 0;">Transaction
        History</h2>
      <a href="{% url 'mentor_dashboard' %}" class="btn-preview"
        style="text-decoration: none; display: flex; align-items: center; gap: 4px;">
        <span class="material-icons" style="font-size: 18px;">arrow_back</span>
        <span>Back to Dashboard</span>
      </a>
    </div>

    <div style="overflow-x: auto;">
      <table class="premium-table">
        <thead>
          <tr>
            <th>Date</th>
            <th>Course</th>
            <th>Student</th>
            <th>Rate</th>
            <th>Commission</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for comm in commissions %}
          <tr>
            <td style="color: var(--text-muted);">{{ comm.created_at|date:"M d, Y H:i" }}</td>
            <td style="font-weight: 600; color: var(--text-main);">{{ comm.course.title }}</td>
            <td>
              <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                <div
                  style="width: 32px; height: 32px; background: var(--primary-light); color: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 12px;">
                  {{ comm.enrollment.user.username|first|upper }}
                </div>
                <span>{{ comm.enrollment.user.get_full_name|default:comm.enrollment.user.username }}</span>
              </div>
            </td>
            <td>
              {% if comm.rate_type == 'percentage' %}
              {{ comm.rate_value|floatformat:0 }}%
              {% else %}
              Rp {{ comm.rate_value|rupiah }}
              {% endif %}
            </td>
            <td style="font-weight: 700; color: #10b981;">+ Rp {{ comm.amount|rupiah }}</td>
            <td>
              <span class="badge-status {% if comm.status == 'paid' %}status-paid{% else %}status-pending{% endif %}">
                {{ comm.get_status_display }}
              </span>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6" style="text-align: center; padding: var(--spacing-4xl);">
              <div
                style="width: 64px; height: 64px; margin: 0 auto var(--spacing-md); background: var(--gray-100); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center;">
                <span class="material-icons" style="font-size: 32px; color: var(--text-muted);">receipt_long</span>
              </div>
              <p style="font-weight: 600; color: var(--text-main);">No commission history found.</p>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
