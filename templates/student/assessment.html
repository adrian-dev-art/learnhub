{% extends 'shared/base.html' %}

{% block title %}Assessment - {{ enrollment.course.title }}{% endblock %}

{% block content %}
<div class="container py-4">
  <div style="max-width: 800px; margin: 0 auto;">
    <div class="text-center mb-4">
      <h1 style="font-size: var(--font-size-2xl); font-weight: 600; margin-bottom: var(--spacing-sm); color: white;">
        Course Assessment
      </h1>
      <p style="color: var(--gray-400);">{{ assessment.title }}</p>
    </div>

    <div class="card mb-4" style="background: #1e293b; border: 1px solid #334155;">
      <div class="card-body">
        <div style="display: flex; align-items: center; gap: var(--spacing-lg); justify-content: center;">
          <div style="text-align: center;">
            <span class="material-icons"
              style="font-size: 2.5rem; color: #fbbf24; filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.4));">quiz</span>
            <div style="margin-top: var(--spacing-xs); color: white; font-weight: 500;">{{ questions|length }} Questions
            </div>
          </div>
          <div style="text-align: center;">
            <span class="material-icons"
              style="font-size: 2.5rem; color: #34d399; filter: drop-shadow(0 0 8px rgba(52, 211, 153, 0.4));">workspace_premium</span>
            <div style="margin-top: var(--spacing-xs); color: white; font-weight: 500;">{{ assessment.passing_score }}%
              to Pass</div>
          </div>
        </div>
      </div>
    </div>

    <div class="card" style="background: #0f172a; border: 1px solid #1e293b;">
      <div class="card-body">
        <form method="post">
          {% csrf_token %}

          {% for question in questions %}
          <div class="form-group"
            style="padding: var(--spacing-lg); background: #1e293b; border-radius: var(--radius-md); margin-bottom: var(--spacing-lg); border: 1px solid #334155;">
            <h3 style="margin-bottom: var(--spacing-md); display: flex; align-items: center; gap: var(--spacing-sm);">
              <span class="badge badge-primary"
                style="background-color: var(--primary-500); color: white;">{{forloop.counter }}</span>
              <span style="color: white; font-weight: 600;">{{ question.text }}</span>
            </h3>

            {% if question.image %}
            <div class="mb-3">
              <img src="{{ question.image.url }}" alt="Question Image"
                style="max-width: 100%; border-radius: var(--radius-md); box-shadow: var(--shadow-lg);">
            </div>
            {% endif %}

            <div style="display: flex; flex-direction: column; gap: var(--spacing-sm);">
              {% with field=question.form_field %}
              {% for choice in question.choices.all %}
              <label class="choice-container"
                style="display: flex; align-items: center; gap: var(--spacing-md); padding: var(--spacing-md); background: #334155; border: 1px solid #475569; border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s; color: white;">
                <input type="radio" name="question_{{ question.id }}" value="{{ choice.id }}" required
                  style="width: 1.2rem; height: 1.2rem; cursor: pointer; accent-color: var(--primary-400);">
                <div style="flex: 1;">
                  <div style="font-weight: 500;">{{ choice.text }}</div>
                  {% if choice.image %}
                  <div style="margin-top: var(--spacing-xs);">
                    <img src="{{ choice.image.url }}" alt="Choice Image"
                      style="max-height: 150px; border-radius: var(--radius-sm);">
                  </div>
                  {% endif %}
                </div>
              </label>
              {% endfor %}
              {% endwith %}
            </div>
          </div>
          {% endfor %}

          <button type="submit" class="btn btn-primary btn-lg submit-btn"
            style="width: 100%; justify-content: center; margin-top: var(--spacing-lg); background: var(--primary-600); border: none; color: white; font-weight: 600; display: flex; align-items: center; gap: var(--spacing-sm);">
            <span class="material-icons">send</span>
            <span>Submit Assessment</span>
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<style>
  .choice-container:hover {
    border-color: var(--primary-400) !important;
    background-color: #475569 !important;
    transform: translateY(-2px);
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  }

  .choice-container:has(input:checked) {
    border-color: var(--primary-400) !important;
    background-color: #1e293b !important;
    box-shadow: inset 0 0 0 1px var(--primary-400);
  }

  .submit-btn:hover {
    background-color: var(--primary-500) !important;
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }
</style>
{% endblock %}